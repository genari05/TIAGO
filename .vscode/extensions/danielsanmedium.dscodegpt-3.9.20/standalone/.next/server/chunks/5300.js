"use strict";exports.id=5300,exports.ids=[5300],exports.modules={85300:(e,t,r)=>{r.d(t,{F0:()=>eA,lu:()=>eE,qy:()=>ew,wn:()=>eC});var n,a,o,i,s,l,u,c,d,p,f=r(81760),m=r(33888),h=r(7410),y=r(8234),v=r(58117),g=Object.defineProperty,z=(e,t)=>{for(var r in t)g(e,r,{get:t[r],enumerable:!0})};async function x(e){return void 0===e?Promise.resolve():new Promise(t=>setTimeout(t,e))}var b="AI_RetryError",T=`vercel.ai.error.${b}`,w=Symbol.for(T),S=class extends f.AX{constructor({message:e,reason:t,errors:r}){super({name:b,message:e}),this[n]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return f.AX.hasMarker(e,T)}static isRetryError(e){return e instanceof Error&&e.name===b&&"string"==typeof e.reason&&Array.isArray(e.errors)}toJSON(){return{name:this.name,message:this.message,reason:this.reason,lastError:this.lastError,errors:this.errors}}};n=w;var A={spanContext:()=>E,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},E={traceId:"",spanId:"",traceFlags:0},I="AI_DownloadError",_=`vercel.ai.error.${I}`,R=Symbol.for(_),$=class extends f.AX{constructor({url:e,statusCode:t,statusText:r,cause:n,message:o=null==n?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:I,message:o,cause:n}),this[a]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return f.AX.hasMarker(e,_)}static isDownloadError(e){return e instanceof Error&&e.name===I&&"string"==typeof e.url&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.statusText||"string"==typeof e.statusText)}toJSON(){return{name:this.name,message:this.message,url:this.url,statusCode:this.statusCode,statusText:this.statusText,cause:this.cause}}};a=R;var j="AI_InvalidDataContentError",k=`vercel.ai.error.${j}`,C=Symbol.for(k),M=class extends f.AX{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:j,message:r,cause:t}),this[o]=!0,this.content=e}static isInstance(e){return f.AX.hasMarker(e,k)}static isInvalidDataContentError(e){return e instanceof Error&&e.name===j&&null!=e.content}toJSON(){return{name:this.name,message:this.message,stack:this.stack,cause:this.cause,content:this.content}}};o=C;var N=h.z.union([h.z.string(),h.z.instanceof(Uint8Array),h.z.instanceof(ArrayBuffer),h.z.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),D="AI_InvalidMessageRoleError",X=`vercel.ai.error.${D}`,q=Symbol.for(X);f.AX,i=q;var F="AI_InvalidArgumentError",O=`vercel.ai.error.${F}`,J=Symbol.for(O);f.AX,s=J;var B=h.z.lazy(()=>h.z.union([h.z.null(),h.z.string(),h.z.number(),h.z.boolean(),h.z.record(h.z.string(),B),h.z.array(B)])),P=h.z.record(h.z.string(),h.z.record(h.z.string(),B)),L=h.z.array(h.z.union([h.z.object({type:h.z.literal("text"),text:h.z.string()}),h.z.object({type:h.z.literal("image"),data:h.z.string(),mimeType:h.z.string().optional()})])),U=h.z.object({type:h.z.literal("text"),text:h.z.string(),experimental_providerMetadata:P.optional()}),V=h.z.object({type:h.z.literal("image"),image:h.z.union([N,h.z.instanceof(URL)]),mimeType:h.z.string().optional(),experimental_providerMetadata:P.optional()}),G=h.z.object({type:h.z.literal("file"),data:h.z.union([N,h.z.instanceof(URL)]),mimeType:h.z.string(),experimental_providerMetadata:P.optional()}),H=h.z.object({type:h.z.literal("tool-call"),toolCallId:h.z.string(),toolName:h.z.string(),args:h.z.unknown()}),W=h.z.object({type:h.z.literal("tool-result"),toolCallId:h.z.string(),toolName:h.z.string(),result:h.z.unknown(),content:L.optional(),isError:h.z.boolean().optional(),experimental_providerMetadata:P.optional()}),K=h.z.object({role:h.z.literal("system"),content:h.z.string(),experimental_providerMetadata:P.optional()}),Q=h.z.object({role:h.z.literal("user"),content:h.z.union([h.z.string(),h.z.array(h.z.union([U,V,G]))]),experimental_providerMetadata:P.optional()}),Y=h.z.object({role:h.z.literal("assistant"),content:h.z.union([h.z.string(),h.z.array(h.z.union([U,H]))]),experimental_providerMetadata:P.optional()}),Z=h.z.object({role:h.z.literal("tool"),content:h.z.array(W),experimental_providerMetadata:P.optional()});h.z.union([K,Q,Y,Z]);var ee="AI_MessageConversionError",et=`vercel.ai.error.${ee}`,er=Symbol.for(et);function en(e,{contentType:t,dataStreamVersion:r}){var n;let a=new Headers(null!=(n=null==e?void 0:e.headers)?n:{});return a.has("Content-Type")||a.set("Content-Type",t),void 0!==r&&a.set("X-Vercel-AI-Data-Stream",r),a}f.AX,l=er;var ea="AI_NoObjectGeneratedError",eo=`vercel.ai.error.${ea}`,ei=Symbol.for(eo),es=class extends f.AX{constructor({message:e="No object generated."}={}){super({name:ea,message:e}),this[u]=!0}static isInstance(e){return f.AX.hasMarker(e,eo)}static isNoObjectGeneratedError(e){return e instanceof Error&&e.name===ea}toJSON(){return{name:this.name,cause:this.cause,message:this.message,stack:this.stack}}};u=ei;(0,m.bF)({prefix:"aiobj",size:24});(0,m.bF)({prefix:"aiobj",size:24});var el="AI_InvalidToolArgumentsError",eu=`vercel.ai.error.${el}`,ec=Symbol.for(eu);f.AX,c=ec;var ed="AI_NoSuchToolError",ep=`vercel.ai.error.${ed}`,ef=Symbol.for(ep);f.AX,d=ef;function em(e,t){let r,n;let a=e.getReader(),o=t.getReader(),i=!1,s=!1;async function l(e){try{null==r&&(r=a.read());let t=await r;r=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==n&&(n=o.read());let t=await n;n=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(i){await u(e);return}if(s){await l(e);return}null==r&&(r=a.read()),null==n&&(n=o.read());let{result:t,reader:c}=await Promise.race([r.then(e=>({result:e,reader:a})),n.then(e=>({result:e,reader:o}))]);t.done||e.enqueue(t.value),c===a?(r=void 0,t.done&&(await u(e),i=!0)):(n=void 0,t.done&&(s=!0,await l(e)))}catch(t){e.error(t)}},cancel(){a.cancel(),o.cancel()}})}(0,m.bF)({prefix:"aitxt",size:24}),(0,m.bF)({prefix:"aitxt",size:24});var eh="AI_NoSuchProviderError",ey=`vercel.ai.error.${eh}`,ev=Symbol.for(ey);function eg(e){let t=new TextEncoder,r="",n=e||{};return new TransformStream({async start(){n.onStart&&await n.onStart()},async transform(e,a){let o="string"==typeof e?e:e.content;a.enqueue(t.encode(o)),r+=o,n.onToken&&await n.onToken(o),n.onText&&"string"==typeof e&&await n.onText(e)},async flush(){n.onCompletion&&await n.onCompletion(r),!n.onFinal||"experimental_onFunctionCall"in n||await n.onFinal(r)}})}function ez(){let e=!0;return t=>(e&&(t=t.trimStart())&&(e=!1),t)}function ex(e){let t=e[Symbol.asyncIterator]();return new ReadableStream({async pull(e){let{done:r,value:n}=await t.next();r?e.close():e.enqueue(n)},async cancel(e){var r;await (null==(r=t.return)?void 0:r.call(t,e))}})}function eb(){let e=new TextEncoder,t=new TextDecoder;return new TransformStream({transform:async(r,n)=>{let a=t.decode(r);n.enqueue(e.encode((0,v.vl)("text",a)))}})}async function*eT(e){for await(let t of e)if("completion"in t){let e=t.completion;e&&(yield e)}else if("delta"in t){let{delta:e}=t;if("text"in e){let t=e.text;t&&(yield t)}}}function ew(e,t){if(Symbol.asyncIterator in e)return ex(eT(e)).pipeThrough(eg(t)).pipeThrough(eb());{let r;return(function(e,t,r){if(!e.ok){if(!e.body)return new ReadableStream({start(e){e.error(Error("Response error: No response body"))}});{let t=e.body.getReader();return new ReadableStream({async start(e){let{done:r,value:n}=await t.read();if(!r){let t=new TextDecoder().decode(n);e.error(Error(`Response error: ${t}`))}}})}}return(e.body||new ReadableStream({start(e){e.close()}})).pipeThrough(function(e){let t;let r=new TextDecoder;return new TransformStream({async start(r){t=(0,y.j)(t=>{if("data"in t&&"event"===t.type&&"[DONE]"===t.data||"done"===t.event){r.terminate();return}if("data"in t){let n=e?e(t.data,{event:t.event}):t.data;n&&r.enqueue(n)}})},transform(e){t.feed(r.decode(e))}})}(t)).pipeThrough(eg(r))})(e,(r="",e=>{let t=JSON.parse(e);if("error"in t)throw Error(`${t.error.type}: ${t.error.message}`);if(!("completion"in t))return;let n=t.completion;if(!r||n.length>r.length&&n.startsWith(r)){let e=n.slice(r.length);return r=n,e}return n}),t).pipeThrough(eb())}}f.JJ,p=ev;new TextDecoder("utf-8");async function*eS(e){var t,r,n;for await(let a of e.stream){let e=null==(n=null==(r=null==(t=a.candidates)?void 0:t[0])?void 0:r.content)?void 0:n.parts;if(void 0===e)continue;let o=e[0];"string"==typeof o.text&&(yield o.text)}}function eA(e,t){return ex(eS(e)).pipeThrough(eg(t)).pipeThrough(eb())}function eE(e,t){return(function(e){let t=ez();return new ReadableStream({async pull(r){var n,a;let{value:o,done:i}=await e.next();if(i){r.close();return}let s=t(null!=(a=null==(n=o.token)?void 0:n.text)?a:"");if(s){if(null!=o.generated_text&&o.generated_text.length>0||"</s>"===s||"<|endoftext|>"===s||"<|end|>"===s)return;r.enqueue(s)}}})})(e).pipeThrough(eg(t)).pipeThrough(eb())}function eI(e,t){return e_(e,t)}function e_(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var r;if("string"==typeof e){t.enqueue(e);return}if("event"in e){"on_chat_model_stream"===e.event&&e$(null==(r=e.data)?void 0:r.chunk,t);return}e$(e,t)}})).pipeThrough(eg(t)).pipeThrough(eb())}function eR(e,t){var r;let n=e_(e,null==t?void 0:t.callbacks),a=null==t?void 0:t.data,o=null==t?void 0:t.init;return new Response(a?em(a.stream,n):n,{status:null!=(r=null==o?void 0:o.status)?r:200,statusText:null==o?void 0:o.statusText,headers:en(o,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function e$(e,t){if("string"==typeof e.content)t.enqueue(e.content);else for(let r of e.content)"text"===r.type&&t.enqueue(r.text)}function ej(e,t){return(function(e){let t=e[Symbol.asyncIterator](),r=ez();return new ReadableStream({async pull(e){var n;let{value:a,done:o}=await t.next();if(o){e.close();return}let i=r(null!=(n=a.delta)?n:"");i&&e.enqueue(i)}})})(e).pipeThrough(eg(t)).pipeThrough(eb())}function ek(e,t={}){var r;let{init:n,data:a,callbacks:o}=t,i=ej(e,o);return new Response(a?em(a.stream,i):i,{status:null!=(r=null==n?void 0:n.status)?r:200,statusText:null==n?void 0:n.statusText,headers:en(n,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}z({},{toAIStream:()=>eI,toDataStream:()=>e_,toDataStreamResponse:()=>eR}),z({},{toDataStream:()=>ej,toDataStreamResponse:()=>ek});Symbol("internal_openai_fn_messages");var eC=class extends Response{constructor(e,t,r){let n=e;r&&(n=em(r.stream,e)),super(n,{...t,status:200,headers:en(t,{contentType:"text/plain; charset=utf-8"})})}}}};